<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>消息队列实战</title>
    <link href="/2024/01/02/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E5%AE%9E%E6%88%98/"/>
    <url>/2024/01/02/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E5%AE%9E%E6%88%98/</url>
    
    <content type="html"><![CDATA[<h2 id="初始化消息队列"><a href="#初始化消息队列" class="headerlink" title="初始化消息队列"></a>初始化消息队列</h2><p>Channel 频道：理解为操作消息队列的 client（比如 jdbcClient、redisClient），提供了和消息队列 server 建立通信的传输方法（为了复用连接，提高传输效率）。程序通过 channel 操作 rabbitmq（收发消息）<br>创建消息队列参数：<br>queueName：消息队列名称（注意，同名称的消息队列，只能用同样的参数创建一次）<br>durabale：消息队列重启后，消息是否丢失<br>exclusive：是否只允许当前这个创建消息队列的连接操作消息队列<br>autoDelete：没有人用队列后，是否要删除队列</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 用于创建测试程序用到的交换机和队列（只用在程序启动前执行一次）</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InitRabbitMqBean</span> &#123;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;spring.rabbitmq.host:localhost&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String host;<br><br>    <span class="hljs-meta">@PostConstruct</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 创建连接工厂</span><br>            <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();<br>            factory.setHost(host);<br>            <span class="hljs-comment">// 建立连接、创建频道</span><br>            <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();<br>            <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel();<br>            <span class="hljs-comment">// 创建交换机</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">exchangeName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;code_exchange&quot;</span>;<br>            channel.exchangeDeclare(exchangeName, <span class="hljs-string">&quot;direct&quot;</span>);<br>            <span class="hljs-comment">// 创建队列</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">queueName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;code_queue&quot;</span>;<br>            <span class="hljs-comment">// 参数</span><br>            <span class="hljs-comment">// durable: 是否开启持久化。消息队列重启后，消息是否丢失</span><br>            <span class="hljs-comment">// exclusive: 是否允许当前这个创建消息队列的连接操作消息队列</span><br>            <span class="hljs-comment">// autoDelete: 没有人用队列后，是否要删除队列</span><br>            channel.queueDeclare(queueName, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);<br>            <span class="hljs-comment">// 交换机与消息队列进行绑定</span><br>            <span class="hljs-comment">// routingKey: 控制消息要转发到哪个队列</span><br>            channel.queueBind(queueName, exchangeName, <span class="hljs-string">&quot;my_routingKey&quot;</span>);<br>            log.info(<span class="hljs-string">&quot;消息队列启动成功&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            log.error(<span class="hljs-string">&quot;消息队列启动失败&quot;</span>, e);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="生产者"><a href="#生产者" class="headerlink" title="生产者"></a>生产者</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMessage</span><span class="hljs-params">(String exchange, String routingKey, String message)</span> &#123;<br>        rabbitTemplate.convertAndSend(exchange, routingKey, message);<br> &#125;<br></code></pre></td></tr></table></figure><p>rabbitTemplate 的 convertAndSend()方法可以给指定队列发送消息，函数有三个参数，第一个是交换机(exchange)的名字,第二个是路由键(routing-key)的名字，第三个则为消息的内容。</p><h2 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h2><h3 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h3><p>1）队列持久化<br>durable 参数设置为 true，服务器重启后队列不丢失：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">channel.queueDeclare(TASK_QUEUE_NAME, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);<br></code></pre></td></tr></table></figure><p>2）消息持久化<br>指定 MessageProperties.PERSISTENT_TEXT_PLAIN 参数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Java">channel.basicPublish(<span class="hljs-string">&quot;&quot;</span>, TASK_QUEUE_NAME,<br>        MessageProperties.PERSISTENT_TEXT_PLAIN,<br>        message.getBytes(<span class="hljs-string">&quot;UTF-8&quot;</span>));<br></code></pre></td></tr></table></figure><h3 id="控制单个消费者的处理任务积压数："><a href="#控制单个消费者的处理任务积压数：" class="headerlink" title="控制单个消费者的处理任务积压数："></a>控制单个消费者的处理任务积压数：</h3><p>每个消费者最多同时处理 1 个任务</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">channel.basicQos(<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><h3 id="消息确认机制："><a href="#消息确认机制：" class="headerlink" title="消息确认机制："></a>消息确认机制：</h3><p>为了保证消息成功被消费（快递成功被取走），rabbitmq 提供了消息确认机制，当消费者接收到消息后，比如要给一个反馈：</p><ul><li>ack：消费成功</li><li>nack：消费失败</li><li>reject：拒绝</li></ul><p><strong>如果告诉 rabbitmq 服务器消费成功，服务器才会放心地移除消息。</strong><br>支持配置 autoack，会自动执行 ack 命令，接收到消息立刻就成功了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java">channel.basicConsume(TASK_QUEUE_NAME, <span class="hljs-literal">false</span>, deliverCallback, consumerTag -&gt; &#123;<br>            &#125;);<br></code></pre></td></tr></table></figure><p><strong>建议 autoack 改为 false，根据实际情况，去手动确认。</strong><br>指定确认某条消息：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">channel.basicAck(delivery.getEnvelope().getDeliveryTag(), );<br></code></pre></td></tr></table></figure><p>第二个参数 multiple(多个) 批量确认：是指是否要一次性确认所有的历史消息直到当前这条</p><p>指定拒绝某条消息：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">channel.basicNack(delivery.getEnvelope().getDeliveryTag(), <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);<br></code></pre></td></tr></table></figure><p>第 3 个参数表示是否重新入队，可用于重试</p><h3 id="消息过期机制"><a href="#消息过期机制" class="headerlink" title="消息过期机制"></a>消息过期机制</h3><p>官方文档：<a href="https://www.rabbitmq.com/ttl.html">https://www.rabbitmq.com/ttl.html</a><br>可以给每条消息指定一个有效期，一段时间内未被消费者处理，就过期了。<br>示例场景：消费者（库存系统）挂了，一个订单 15 分钟还没被库存系统处理，这个订单其实已经失效了，哪怕库存系统再恢复，其实也不用扣减库存。<br>适用场景：清理过期数据、模拟延迟队列的实现（不开会员就慢速）、专门让某个程序处理过期请求<br>1）给队列中的所有消息指定过期时间</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">// 创建队列，指定消息过期参数</span><br>Map&lt;String, Object&gt; args = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;String, Object&gt;();<br>args.put(<span class="hljs-string">&quot;x-message-ttl&quot;</span>, <span class="hljs-number">5000</span>);<br><span class="hljs-comment">// args 指定参数</span><br>channel.queueDeclare(QUEUE_NAME, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, args);<br></code></pre></td></tr></table></figure><p>2）给某条消息指定过期时间<br>语法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">// 给消息指定过期时间</span><br>AMQP.<span class="hljs-type">BasicProperties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMQP</span>.BasicProperties.Builder()<br>        .expiration(<span class="hljs-string">&quot;1000&quot;</span>)<br>        .build();<br>channel.basicPublish(<span class="hljs-string">&quot;my-exchange&quot;</span>, <span class="hljs-string">&quot;routing-key&quot;</span>, properties, message.getBytes(StandardCharsets.UTF_8));<br></code></pre></td></tr></table></figure><p>如果在过期时间内，还没有消费者取消息，消息才会过期。<br>注意，如果消息已经接收到，但是没确认，是不会过期的。</p><blockquote><p>如果消息处于待消费状态并且过期时间到达后，消息将被标记为过期。但是，如果消息已经被消费者消费，并且正在处理过程中，即使过期时间到达，消息仍然会被正常处理。</p></blockquote><h2 id="交换机"><a href="#交换机" class="headerlink" title="交换机"></a>交换机</h2><p>一个生产者给 多个 队列发消息，1 个生产者对多个队列。<br>交换机的作用：提供消息转发功能，类似于网络路由器<br>要解决的问题：怎么把消息转发到不同的队列上，好让消费者从不同的队列消费。<br>绑定：交换机和队列关联起来，也可以叫路由，算是一个算法或转发策略<br>绑定代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java">channel.queueBind(queueName, EXCHANGE_NAME, <span class="hljs-string">&quot;绑定规则&quot;</span>);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>代码编辑器实践</title>
    <link href="/2023/11/15/%E4%BB%A3%E7%A0%81%E7%BC%96%E8%BE%91%E5%99%A8%E5%AE%9E%E8%B7%B5/"/>
    <url>/2023/11/15/%E4%BB%A3%E7%A0%81%E7%BC%96%E8%BE%91%E5%99%A8%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<p>微软官方编辑器：<a href="https://github.com/microsoft/monaco-editor">https://github.com/microsoft/monaco-editor</a><br>官方提供的整合教程：<a href="https://github.com/microsoft/monaco-editor/blob/main/docs/integrate-esm.md">https://github.com/microsoft/monaco-editor/blob/main/docs/integrate-esm.md</a></p><h2 id="1）安装编辑器"><a href="#1）安装编辑器" class="headerlink" title="1）安装编辑器"></a>1）安装编辑器</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install monaco-editor<br></code></pre></td></tr></table></figure><h2 id="2）vue-cli-项目（webpack-项目）整合-monaco-editor-编辑器-。"><a href="#2）vue-cli-项目（webpack-项目）整合-monaco-editor-编辑器-。" class="headerlink" title="2）vue-cli 项目（webpack 项目）整合 monaco-editor(编辑器)。"></a>2）vue-cli 项目（webpack 项目）整合 monaco-editor(编辑器)。</h2><p>先安装 monaco-editor(编辑器)-webpack-plugin（<a href="https://github.com/microsoft/monaco-editor/blob/main/webpack-plugin/README.md%EF%BC%89%EF%BC%9A">https://github.com/microsoft/monaco-editor/blob/main/webpack-plugin/README.md）：</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install monaco-editor-webpack-plugin<br></code></pre></td></tr></table></figure><h4 id="在-vue-config-js-中配置-webpack-插件："><a href="#在-vue-config-js-中配置-webpack-插件：" class="headerlink" title="在 vue.config.js 中配置 webpack 插件："></a>在 vue.config.js 中配置 webpack 插件：</h4><h4 id="全量加载："><a href="#全量加载：" class="headerlink" title="全量加载："></a>全量加载：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; defineConfig &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vue/cli-service&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MonacoWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;monaco-editor-webpack-plugin&quot;</span>);<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">transpileDependencies</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-title function_">chainWebpack</span>(<span class="hljs-params">config</span>) &#123;<br>    config.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">&quot;monaco&quot;</span>).<span class="hljs-title function_">use</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MonacoWebpackPlugin</span>());<br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><h4 id="按需加载："><a href="#按需加载：" class="headerlink" title="按需加载："></a>按需加载：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">MonacoWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;monaco-editor-webpack-plugin&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">chainWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> &#123;<br>    config.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">&#x27;monaco-editor&#x27;</span>).<span class="hljs-title function_">use</span>(<span class="hljs-title class_">MonacoWebpackPlugin</span>, [<br>      &#123;<br>        <span class="hljs-comment">// Languages are loaded on demand at runtime</span><br>        <span class="hljs-attr">languages</span>: [<span class="hljs-string">&#x27;json&#x27;</span>, <span class="hljs-string">&#x27;go&#x27;</span>, <span class="hljs-string">&#x27;css&#x27;</span>, <span class="hljs-string">&#x27;html&#x27;</span>, <span class="hljs-string">&#x27;java&#x27;</span>, <span class="hljs-string">&#x27;javascript&#x27;</span>, <span class="hljs-string">&#x27;less&#x27;</span>, <span class="hljs-string">&#x27;markdown&#x27;</span>, <span class="hljs-string">&#x27;mysql&#x27;</span>, <span class="hljs-string">&#x27;php&#x27;</span>, <span class="hljs-string">&#x27;python&#x27;</span>, <span class="hljs-string">&#x27;scss&#x27;</span>, <span class="hljs-string">&#x27;shell&#x27;</span>, <span class="hljs-string">&#x27;redis&#x27;</span>, <span class="hljs-string">&#x27;sql&#x27;</span>, <span class="hljs-string">&#x27;typescript&#x27;</span>, <span class="hljs-string">&#x27;xml&#x27;</span>], <span class="hljs-comment">// [&#x27;abap&#x27;, &#x27;apex&#x27;, &#x27;azcli&#x27;, &#x27;bat&#x27;, &#x27;cameligo&#x27;, &#x27;clojure&#x27;, &#x27;coffee&#x27;, &#x27;cpp&#x27;, &#x27;csharp&#x27;, &#x27;csp&#x27;, &#x27;css&#x27;, &#x27;dart&#x27;, &#x27;dockerfile&#x27;, &#x27;ecl&#x27;, &#x27;fsharp&#x27;, &#x27;go&#x27;, &#x27;graphql&#x27;, &#x27;handlebars&#x27;, &#x27;hcl&#x27;, &#x27;html&#x27;, &#x27;ini&#x27;, &#x27;java&#x27;, &#x27;javascript&#x27;, &#x27;json&#x27;, &#x27;julia&#x27;, &#x27;kotlin&#x27;, &#x27;less&#x27;, &#x27;lexon&#x27;, &#x27;lua&#x27;, &#x27;m3&#x27;, &#x27;markdown&#x27;, &#x27;mips&#x27;, &#x27;msdax&#x27;, &#x27;mysql&#x27;, &#x27;objective-c&#x27;, &#x27;pascal&#x27;, &#x27;pascaligo&#x27;, &#x27;perl&#x27;, &#x27;pgsql&#x27;, &#x27;php&#x27;, &#x27;postiats&#x27;, &#x27;powerquery&#x27;, &#x27;powershell&#x27;, &#x27;pug&#x27;, &#x27;python&#x27;, &#x27;r&#x27;, &#x27;razor&#x27;, &#x27;redis&#x27;, &#x27;redshift&#x27;, &#x27;restructuredtext&#x27;, &#x27;ruby&#x27;, &#x27;rust&#x27;, &#x27;sb&#x27;, &#x27;scala&#x27;, &#x27;scheme&#x27;, &#x27;scss&#x27;, &#x27;shell&#x27;, &#x27;solidity&#x27;, &#x27;sophia&#x27;, &#x27;sql&#x27;, &#x27;st&#x27;, &#x27;swift&#x27;, &#x27;systemverilog&#x27;, &#x27;tcl&#x27;, &#x27;twig&#x27;, &#x27;typescript&#x27;, &#x27;vb&#x27;, &#x27;xml&#x27;, &#x27;yaml&#x27;],</span><br>        <span class="hljs-attr">features</span>: [<span class="hljs-string">&#x27;format&#x27;</span>, <span class="hljs-string">&#x27;find&#x27;</span>, <span class="hljs-string">&#x27;contextmenu&#x27;</span>, <span class="hljs-string">&#x27;gotoError&#x27;</span>, <span class="hljs-string">&#x27;gotoLine&#x27;</span>, <span class="hljs-string">&#x27;gotoSymbol&#x27;</span>, <span class="hljs-string">&#x27;hover&#x27;</span> , <span class="hljs-string">&#x27;documentSymbols&#x27;</span>] <span class="hljs-comment">//[&#x27;accessibilityHelp&#x27;, &#x27;anchorSelect&#x27;, &#x27;bracketMatching&#x27;, &#x27;caretOperations&#x27;, &#x27;clipboard&#x27;, &#x27;codeAction&#x27;, &#x27;codelens&#x27;, &#x27;colorPicker&#x27;, &#x27;comment&#x27;, &#x27;contextmenu&#x27;, &#x27;coreCommands&#x27;, &#x27;cursorUndo&#x27;, &#x27;dnd&#x27;, &#x27;documentSymbols&#x27;, &#x27;find&#x27;, &#x27;folding&#x27;, &#x27;fontZoom&#x27;, &#x27;format&#x27;, &#x27;gotoError&#x27;, &#x27;gotoLine&#x27;, &#x27;gotoSymbol&#x27;, &#x27;hover&#x27;, &#x27;iPadShowKeyboard&#x27;, &#x27;inPlaceReplace&#x27;, &#x27;indentation&#x27;, &#x27;inlineHints&#x27;, &#x27;inspectTokens&#x27;, &#x27;linesOperations&#x27;, &#x27;linkedEditing&#x27;, &#x27;links&#x27;, &#x27;multicursor&#x27;, &#x27;parameterHints&#x27;, &#x27;quickCommand&#x27;, &#x27;quickHelp&#x27;, &#x27;quickOutline&#x27;, &#x27;referenceSearch&#x27;, &#x27;rename&#x27;, &#x27;smartSelect&#x27;, &#x27;snippets&#x27;, &#x27;suggest&#x27;, &#x27;toggleHighContrast&#x27;, &#x27;toggleTabFocusMode&#x27;, &#x27;transpose&#x27;, &#x27;unusualLineTerminators&#x27;, &#x27;viewportSemanticTokens&#x27;, &#x27;wordHighlighter&#x27;, &#x27;wordOperations&#x27;, &#x27;wordPartOperations&#x27;]</span><br>      &#125;<br>    ])<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="如何使用-Monaco-Editor-编辑器-？查看示例教程："><a href="#如何使用-Monaco-Editor-编辑器-？查看示例教程：" class="headerlink" title="如何使用 Monaco Editor(编辑器)？查看示例教程："></a>如何使用 Monaco Editor(编辑器)？查看示例教程：</h2><p><a href="https://microsoft.github.io/monaco-editor/playground.html?source=v0.40.0#example-creating-the-editor-hello-world">https://microsoft.github.io/monaco-editor/playground.html?source=v0.40.0#example-creating-the-editor-hello-world</a><br>整合教程参考：<a href="http://chart.zhenglinglu.cn/pages/2244bd/#%E5%9C%A8-vue-%E4%B8%AD%E4%BD%BF%E7%94%A8">http://chart.zhenglinglu.cn/pages/2244bd/#%E5%9C%A8-vue-%E4%B8%AD%E4%BD%BF%E7%94%A8</a></p><h4 id="注意-，monaco-editor-编辑器-在读写值的时候，要使用-toRaw-编辑器实例）的语法来执行操作，否则会卡死。"><a href="#注意-，monaco-editor-编辑器-在读写值的时候，要使用-toRaw-编辑器实例）的语法来执行操作，否则会卡死。" class="headerlink" title="注意 ，monaco editor(编辑器) 在读写值的时候，要使用 toRaw(编辑器实例）的语法来执行操作，否则会卡死。"></a>注意 ，monaco editor(编辑器) 在读写值的时候，要使用 toRaw(编辑器实例）的语法来执行操作，否则会卡死。</h4><p>示例整合代码如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div id=&quot;code-editor&quot; ref=&quot;codeEditorRef&quot; style=&quot;min-height: 400px&quot; /&gt;<br>  &#123;&#123; value &#125;&#125;<br>  &lt;a-button @click=&quot;fillValue&quot;&gt;填充值&lt;/a-button&gt;<br>&lt;/template&gt;<br>&lt;script setup lang=&quot;ts&quot;&gt;<br>import * as monaco from &quot;monaco-editor&quot;;<br>import &#123; onMounted, ref, toRaw &#125; from &quot;vue&quot;;<br>const codeEditorRef = ref();<br>const codeEditor = ref();<br>const value = ref(&quot;hello world&quot;);<br>const fillValue = () =&gt; &#123;<br>  if (!codeEditor.value) &#123;<br>    return;<br>  &#125;<br>  // 改变值<br>  toRaw(codeEditor.value).setValue(&quot;新的值&quot;);<br>&#125;;<br>onMounted(() =&gt; &#123;<br>  if (!codeEditorRef.value) &#123;<br>    return;<br>  &#125;<br>  // Hover on each property to see its docs!<br>  codeEditor.value = monaco.editor.create(codeEditorRef.value, &#123;<br>    value: value.value,<br>    language: &quot;java&quot;,<br>    automaticLayout: true,<br>    colorDecorators: true,<br>    minimap: &#123;<br>      enabled: true,<br>    &#125;,<br>    readOnly: false,<br>    theme: &quot;vs-dark&quot;,<br>    // lineNumbers: &quot;off&quot;,<br>    // roundedSelection: false,<br>    // scrollBeyondLastLine: false,<br>  &#125;);<br>  // 编辑 监听内容变化<br>  codeEditor.value.onDidChangeModelContent(() =&gt; &#123;<br>    console.log(&quot;目前内容为：&quot;, toRaw(codeEditor.value).getValue());<br>  &#125;);<br>&#125;);<br>&lt;/script&gt;<br>&lt;style scoped&gt;&lt;/style&gt;<br></code></pre></td></tr></table></figure><h4 id="与-Md-编辑器一样，也要接受父组件的传值，把显示的输入交给父组件去控制，从而能够让父组件实时得到用户输入的代码："><a href="#与-Md-编辑器一样，也要接受父组件的传值，把显示的输入交给父组件去控制，从而能够让父组件实时得到用户输入的代码：" class="headerlink" title="与 Md 编辑器一样，也要接受父组件的传值，把显示的输入交给父组件去控制，从而能够让父组件实时得到用户输入的代码："></a>与 Md 编辑器一样，也要接受父组件的传值，把显示的输入交给父组件去控制，从而能够让父组件实时得到用户输入的代码：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 定义组件属性类型</span><br><span class="hljs-comment"> */</span><br>interface <span class="hljs-title class_">Props</span> &#123;<br>  <span class="hljs-attr">value</span>: string;<br>  <span class="hljs-attr">handleChange</span>: <span class="hljs-function">(<span class="hljs-params">v: string</span>) =&gt;</span> <span class="hljs-keyword">void</span>;<br>&#125;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 给组件指定初始值</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">const</span> props = <span class="hljs-title function_">withDefaults</span>(defineProps&lt;<span class="hljs-title class_">Props</span>&gt;(), &#123;<br>  <span class="hljs-attr">value</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-attr">handleChange</span>: <span class="hljs-function">(<span class="hljs-params">v: string</span>) =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(v);<br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Markdown 编辑器实践</title>
    <link href="/2023/10/12/Markdown%20%E7%BC%96%E8%BE%91%E5%99%A8%E5%AE%9E%E8%B7%B5/"/>
    <url>/2023/10/12/Markdown%20%E7%BC%96%E8%BE%91%E5%99%A8%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<h2 id="如何在项目中使用-Markdown-编辑器"><a href="#如何在项目中使用-Markdown-编辑器" class="headerlink" title="如何在项目中使用 Markdown 编辑器"></a>如何在项目中使用 Markdown 编辑器</h2><h3 id="为什么用-Markdown？"><a href="#为什么用-Markdown？" class="headerlink" title="为什么用 Markdown？"></a>为什么用 Markdown？</h3><p>一套通用的文本编辑语法，可以在各大网站上统一标准、渲染出统一的样式，比较简单易学。<br>推荐的 Md 编辑器：<a href="https://github.com/bytedance/bytemd">https://github.com/bytedance/bytemd</a><br>阅读官方文档，下载编辑器主体、以及 gfm（表格支持）插件、highlight 代码高亮插件</p><h3 id="新建-MdEditor-组件，编写代码："><a href="#新建-MdEditor-组件，编写代码：" class="headerlink" title="新建 MdEditor 组件，编写代码："></a>新建 MdEditor 组件，编写代码：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;Editor :value=&quot;value&quot; :plugins=&quot;plugins&quot; @change=&quot;handleChange&quot; /&gt;<br>&lt;/template&gt;<br>&lt;script setup lang=&quot;ts&quot;&gt;<br>import gfm from &quot;@bytemd/plugin-gfm&quot;;<br>import highlight from &quot;@bytemd/plugin-highlight&quot;;<br>import &#123; Editor, Viewer &#125; from &quot;@bytemd/vue-next&quot;;<br>import &#123; ref &#125; from &quot;vue&quot;;<br>const plugins = [<br>  gfm(),<br>  highlight(),<br>  // Add more plugins here<br>];<br>const value = ref(&quot;&quot;);<br>const handleChange = (v: string) =&gt; &#123;<br>  value.value = v;<br>&#125;;<br>&lt;/script&gt;<br>&lt;style scoped&gt;&lt;/style&gt;<br></code></pre></td></tr></table></figure><h3 id="隐藏编辑器中不需要的操作图标（比如-GitHub-图标）："><a href="#隐藏编辑器中不需要的操作图标（比如-GitHub-图标）：" class="headerlink" title="隐藏编辑器中不需要的操作图标（比如 GitHub 图标）："></a>隐藏编辑器中不需要的操作图标（比如 GitHub 图标）：</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.bytemd-toolbar-icon</span><span class="hljs-selector-class">.bytemd-tippy</span><span class="hljs-selector-class">.bytemd-tippy-right</span><span class="hljs-selector-pseudo">:last-child</span> &#123;<br>    <span class="hljs-attribute">display</span>: none;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="MdEditor-示例代码："><a href="#MdEditor-示例代码：" class="headerlink" title="MdEditor 示例代码："></a>MdEditor 示例代码：</h3><p>要把 MdEditor 当前输入的值暴露给父组件，便于父组件去使用，同时也是提高组件的通用性，需要定义属性，把 value 和 handleChange 事件交给父组件去管理：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vue">/**<br> * 定义组件属性类型<br> */<br>interface Props &#123;<br>  value: string;<br>  handleChange: (v: string) =&gt; void;<br>&#125;<br>/**<br> * 给组件指定初始值<br> */<br>const props = withDefaults(defineProps&lt;Props&gt;(), &#123;<br>  value: () =&gt; &quot;&quot;,<br>  handleChange: (v: string) =&gt; &#123;<br>    console.log(v);<br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CentOS7 配置 JDK 17 环境</title>
    <link href="/2023/10/11/CentOS7%20%E9%85%8D%E7%BD%AE%20JDK%2017%20%E7%8E%AF%E5%A2%83/"/>
    <url>/2023/10/11/CentOS7%20%E9%85%8D%E7%BD%AE%20JDK%2017%20%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<h2 id="1-先确定当前服务器有没有安装java"><a href="#1-先确定当前服务器有没有安装java" class="headerlink" title="1.先确定当前服务器有没有安装java"></a>1.先确定当前服务器有没有安装java</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@centos ~]$ java -version<br>openjdk version <span class="hljs-string">&quot;1.8.0_312&quot;</span><br>OpenJDK Runtime Environment (build 1.8.0_312-b07)<br>OpenJDK 64-Bit Server VM (build 25.312-b07, mixed mode)<br></code></pre></td></tr></table></figure><h2 id="2-确定java安装地址"><a href="#2-确定java安装地址" class="headerlink" title="2.确定java安装地址"></a>2.确定java安装地址</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@centos ~]$ <span class="hljs-built_in">which</span> java<br>/usr/bin/java<br>[root@centos ~]$ <span class="hljs-built_in">ls</span> -lr /usr/bin/java<br>lrwxrwxrwx. 1 root root 22 Oct 31 07:45 /usr/bin/java -&gt; /etc/alternatives/java<br>[root@centos ~]$ <span class="hljs-built_in">ls</span> -lrt /etc/alternatives/java<br>lrwxrwxrwx. 1 root root 73 Oct 31 07:45 /etc/alternatives/java -&gt; /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.312.b07-1.el7_9.x86_64/jre/bin/java<br></code></pre></td></tr></table></figure><p>由此可见jdk安装在&#x2F;usr&#x2F;lib&#x2F;jvm下<br> 那我新下载的jdk 17也安装到这个地址下好了。</p><h2 id="3-下载jdk-17并放到合适的位置上"><a href="#3-下载jdk-17并放到合适的位置上" class="headerlink" title="3.下载jdk 17并放到合适的位置上"></a>3.下载jdk 17并放到合适的位置上</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@centos Downloads]$ wget https://download.oracle.com/java/17/latest/jdk-17_linux-x64_bin.tar.gz<br>[root@centos Downloads]$ tar xf jdk-17_linux-x64_bin.tar.gz<br>[root@centos Downloads]$ <span class="hljs-built_in">mv</span> jdk-17.0.3/ /usr/lib/jvm/jdk-17.0.3<br></code></pre></td></tr></table></figure><h2 id="4-配置环境变量"><a href="#4-配置环境变量" class="headerlink" title="4.配置环境变量"></a>4.配置环境变量</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@centos Downloads]$ sudo vi /etc/profile<br><span class="hljs-comment">#添加以下内容</span><br>[root@centos Downloads]$ <span class="hljs-built_in">tail</span> -n 4 /etc/profile<br><br><span class="hljs-built_in">export</span> JAVA_HOME=/usr/lib/jvm/jdk-17.0.3<br><span class="hljs-built_in">export</span> CLASSPATH=<span class="hljs-variable">$JAVA_HOME</span>/lib:<span class="hljs-variable">$JRE_HOME</span>/lib:<span class="hljs-variable">$CLASSPATH</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$JAVA_HOME</span>/bin:<span class="hljs-variable">$JRE_HOME</span>/bin:<span class="hljs-variable">$PATH</span><br>[root@centos Downloads]$ <span class="hljs-built_in">source</span> /etc/profile<br></code></pre></td></tr></table></figure><h2 id="5-验证安装"><a href="#5-验证安装" class="headerlink" title="5.验证安装"></a>5.验证安装</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@centos Downloads]$ java -version<br>java version <span class="hljs-string">&quot;17.0.3&quot;</span> 2022-04-19 LTS<br>Java(TM) SE Runtime Environment (build 17.0.3+8-LTS-111)<br>Java HotSpot(TM) 64-Bit Server VM (build 17.0.3+8-LTS-111, mixed mode, sharing)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>部署</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenAPI 自动生成接口请求代码</title>
    <link href="/2023/09/04/OpenAPI-%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%E4%BB%A3%E7%A0%81/"/>
    <url>/2023/09/04/OpenAPI-%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E6%8E%A5%E5%8F%A3%E8%AF%B7%E6%B1%82%E4%BB%A3%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<p>OpenAPI Typescript Codegen<br>Node.js库，该库基于OpenAPI规范生成Typescript客户端。<br><a href="https://github.com/ferdikoomen/openapi-typescript-codegen">https://github.com/ferdikoomen/openapi-typescript-codegen</a><br>安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install openapi-typescript-codegen --save-dev<br></code></pre></td></tr></table></figure><p>例如通过请求工具类 Axios：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openapi --input (这里是你的后端接口文档地址) --output ./generated --client axios<br></code></pre></td></tr></table></figure><p>详细用法建议去查看readme</p><p>如果想要自定义请求参数，怎么办？<br>1）使用代码生成器提供的全局参数修改对象：<br>在&#x2F;generated&#x2F;core&#x2F;OpenAPI.ts 可以修改请求地址</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs text">export const OpenAPI: OpenAPIConfig = &#123;<br>    BASE: &#x27;http://localhost:8101&#x27;,<br>    VERSION: &#x27;1.0&#x27;,<br>    WITH_CREDENTIALS: false,<br>    CREDENTIALS: &#x27;include&#x27;,<br>    TOKEN: undefined,<br>    USERNAME: undefined,<br>    PASSWORD: undefined,<br>    HEADERS: undefined,<br>    ENCODE_PATH: undefined,<br>&#125;;<br></code></pre></td></tr></table></figure><p>2）直接定义 axios 请求库的全局参数，比如全局请求响应拦截器<br>文档：<a href="https://axios-http.com/docs/interceptors">https://axios-http.com/docs/interceptors</a><br>示例代码：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs text">// Add a request interceptor<br>import axios from &quot;axios&quot;;<br>axios.interceptors.request.use(<br>  function (config) &#123;<br>    // Do something before request is sent<br>    return config;<br>  &#125;,<br>  function (error) &#123;<br>    // Do something with request error<br>    return Promise.reject(error);<br>  &#125;<br>);<br>// Add a response interceptor<br>axios.interceptors.response.use(<br>  function (response) &#123;<br>    console.log(&quot;响应&quot;, response);<br>    // Any status code that lie within the range of 2xx cause this function to trigger<br>    // Do something with response data<br>    return response;<br>  &#125;,<br>  function (error) &#123;<br>    // Any status codes that falls outside the range of 2xx cause this function to trigger<br>    // Do something with response error<br>    return Promise.reject(error);<br>  &#125;<br>);<br></code></pre></td></tr></table></figure><p>我放在了&#x2F;src&#x2F;plugins&#x2F;axios中<br>接着在main.ts中引入一下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">import &quot;@/plugins/axios&quot;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>typescript</tag>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginx配置文件踩坑</title>
    <link href="/2023/08/21/Nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>
    <url>/2023/08/21/Nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h3 id="前端项目部署配置-Nginx"><a href="#前端项目部署配置-Nginx" class="headerlink" title="前端项目部署配置 Nginx"></a>前端项目部署配置 Nginx</h3><ol><li>首先修改 baseURL</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> requests = axios.<span class="hljs-title function_">create</span>(&#123;<br>    <span class="hljs-comment">//基础路径,发请求URL携带api</span><br>    <span class="hljs-attr">baseURL</span>: <span class="hljs-string">&quot;/api&quot;</span>,<br>&#125;);<br></code></pre></td></tr></table></figure><p>下面是 Nginx 常见的命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">// 编辑配置文件<br>cd /usr/local/nginx/conf<br>vim nginx.conf<br>// 重启Nginx<br>cd /usr/local/nginx/sbin<br>./nginx -s reload<br>// 启动Nginx<br>cd /usr/local/nginx/sbin<br>./nginx<br></code></pre></td></tr></table></figure><ol start="2"><li>将以下内容拷贝进配置文件，注意看以下注释信息进行理解：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs conf">server &#123;<br>    listen 8081; # 前端项目的端口<br>    server_name localhost; # 服务器地址或绑定域名<br><br>    location / &#123;<br>        root /usr/share/nginx/html/dist; # dist包存放的路径<br>        index index.html index.htm;<br>    &#125;<br><br>    location /api/ &#123;<br>        proxy_pass http://ip:port/;<br>        # 当访问路径包含/api时，进行代理跳转。<br>        # 举个栗子：访问的是 http://ip:port/api/user/login<br>        # 则会被代理为 http://ip:port/user/login<br>    &#125;<br>    # 再举个栗子<br>    location /api/ &#123;<br>        proxy_pass http://ip:port;<br>        # 注意：比上面的少一个 &#x27;/&#x27;<br>        # 访问的是 http://ip:port/api/user/login<br>    &#125;<br>    # 再举个栗子<br>    location /api/ &#123;<br>        proxy_pass http://ip:port/test/;<br>        # 访问的是 http://ip:port/test/user/login<br>        # 如果最后少了 &#x27;/&#x27; ，就会代理到 http://ip:port/testuser/login<br>    &#125;<br>    error_page 500 502 503 504 /50x.html;<br>    location = /50x.html &#123;<br>        root html;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>总结：在 nginx 中配置 proxy_pass 时，如果在 proxy_pass 后面的 url 加 ‘&#x2F;‘ ，相当于是绝对根路径，则 nginx 不会把 location 中匹配的路径部分代理走;如果没有 ‘&#x2F;‘ ，则会把匹配的路径部分给代理走。<br>参考文章：<a href="https://blog.csdn.net/wyl9527/article/details/89671506">https://blog.csdn.net/wyl9527/article/details/89671506</a></p><h2 id="location-URI-结尾带不带-x2F"><a href="#location-URI-结尾带不带-x2F" class="headerlink" title="location URI 结尾带不带 &#x2F;"></a>location URI 结尾带不带 &#x2F;</h2><p>参考文章：<a href="https://juejin.cn/post/7044438248495513614">https://juejin.cn/post/7044438248495513614</a></p><p>关于 URI 尾部的  &#x2F;  有三点也需要说明一下。第一点与 location 配置有关，其他两点无关。</p><p>location 中的字符有没有  &#x2F;  都没有影响。也就是说  &#x2F;homepage&#x2F;  和  &#x2F;homepage  是一样的。<br>如果 URI 结构是  <a href="https://domain.com/">https://domain.com/</a>  的形式，尾部有没有  &#x2F;  都不会造成重定向。因为浏览器在发起请求的时候，默认加上了  &#x2F; 。虽然很多浏览器在地址栏里也不会显示  &#x2F; 。<br>如果 URI 的结构是  <a href="https://domain.com/homepage/">https://domain.com/homepage/</a> 。尾部如果缺少  &#x2F;  将导致重定向。因为根据约定，URL 尾部的  &#x2F;  表示目录，没有  &#x2F;  表示文件。所以访问  &#x2F;homepage&#x2F;  时，服务器会自动去该目录下找对应的默认文件。如果访问  &#x2F;homepage  的话，服务器会先去找  homepage  文件，找不到的话会将  homepage  当成目录，重定向到  &#x2F;homepage&#x2F; ，去该目录下找默认文件。</p><h2 id="补充：location-指令说明"><a href="#补充：location-指令说明" class="headerlink" title="补充：location 指令说明"></a>补充：location 指令说明</h2><p>参考文章：<a href="https://developer.aliyun.com/article/898207">https://developer.aliyun.com/article/898207</a></p><p>我们看下 Location 的具体语法：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-keyword">location</span> <span class="hljs-title">[ = | ~ | ~* | ^~ ] uri</span> &#123; ... &#125;<br></code></pre></td></tr></table></figure><p>重点看方括号中的 [ &#x3D; | ~ | <del>* | ^</del> ]，其中 | 分隔的内容表示你可能会用到的语法，其中：</p><ul><li>&#x3D; 表示精确匹配，比如：</li></ul><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">location</span> <span class="hljs-operator">=</span> /test &#123;<br>    return <span class="hljs-number">200</span> <span class="hljs-string">&quot;hello&quot;</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ul><li><p>&#x2F;test ok</p></li><li><p>&#x2F;test&#x2F; not ok</p></li><li><p>&#x2F;test2 not ok</p></li><li><p>&#x2F;test&#x2F;2 not ok</p></li></ul></blockquote><ul><li>~ 表示区分大小写的正则匹配，比如：</li></ul><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-keyword">location</span> <span class="hljs-title">~ ^/test</span>\$ &#123;<br>[ configuration ]<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ul><li><p>&#x2F;test ok</p></li><li><p>&#x2F;Test not ok</p></li><li><p>&#x2F;test&#x2F; not ok</p></li><li><p>&#x2F;test2 not ok</p></li></ul></blockquote><ul><li>~_ 表示不区分大小写的正则匹配<br>location ~_ ^&#x2F;test$ {<br> [ configuration ]<br>}</li></ul><blockquote><ul><li><p>&#x2F;test ok</p></li><li><p>&#x2F;Test ok</p></li><li><p>&#x2F;test&#x2F; not ok</p></li><li><p>&#x2F;test2 not ok</p></li></ul></blockquote><ul><li>^~ 表示 uri 以某个字符串开头<br>location ^~ &#x2F;images&#x2F; {<br> [ configuration ]<br>}</li></ul><blockquote><ul><li>&#x2F;images&#x2F;1.gif ok</li></ul></blockquote><p>而当你不使用这些语法的时候，只写 uri 的时候：<br>&#x2F; 表示通用匹配：<br>location &#x2F; {<br> [ configuration ]<br>}</p><blockquote><ul><li>&#x2F;index.html ok</li></ul></blockquote><p>location &#x2F;test {<br>[ configuration ]<br>}</p><blockquote><ul><li><p>&#x2F;test ok</p></li><li><p>&#x2F;test2 ok</p></li><li><p>&#x2F;test&#x2F; ok</p></li></ul></blockquote><h3 id="location-的定义分为两种"><a href="#location-的定义分为两种" class="headerlink" title="location 的定义分为两种"></a>location 的定义分为两种</h3><ul><li>前缀字符串（prefix(前缀) string(字符串)）</li><li>正则表达式（regular expression(表达)），具体为前面带 ~* 和 ~ 修饰符的<br>而匹配 location 的顺序为：</li></ul><ol><li>检查使用前缀字符串的 locations，在使用前缀字符串的 locations 中选择最长匹配的，并将结果进行储存</li><li>如果符合带有 &#x3D; 修饰符的 URI，则立刻停止匹配</li><li>如果符合带有 ^~ 修饰符的 URI，则也立刻停止匹配。</li><li>然后按照定义文件的顺序，检查正则表达式，匹配到就停止</li><li>当正则表达式匹配不到的时候，使用之前储存的前缀字符串</li></ol><h3 id="再总结一下就是"><a href="#再总结一下就是" class="headerlink" title="再总结一下就是"></a>再总结一下就是</h3><p>在顺序上，前缀字符串顺序不重要，按照匹配长度来确定，正则表达式则按照定义顺序。<br>在优先级上，&#x3D; 修饰符最高，^~ 次之，再者是正则，最后是前缀字符串匹配。</p>]]></content>
    
    
    <categories>
      
      <category>部署</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>密码加密开发流程</title>
    <link href="/2023/08/14/%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/"/>
    <url>/2023/08/14/%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="1-添加依赖"><a href="#1-添加依赖" class="headerlink" title="1. 添加依赖"></a>1. 添加依赖</h2><p>添加 Spring Boot 权限认证依赖</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java">&lt;dependency&gt;<br>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">2.2</span><span class="hljs-number">.1</span>.RELEASE&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><h2 id="2-添加过滤器"><a href="#2-添加过滤器" class="headerlink" title="2.添加过滤器"></a>2.添加过滤器</h2><p>在 config 包下新建 SecurityConfig 类<br>将以下代码添加到类中</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WebSecurityConfigurerAdapter</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        http.authorizeRequests()<br>            .antMatchers(<span class="hljs-string">&quot;/**&quot;</span>)<br>            .permitAll()<br>            .anyRequest()<br>            .authenticated()<br>            .and()<br>            .csrf()<br>            .disable();<br>        &#125;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> BCryptPasswordEncoder <span class="hljs-title function_">bCryptPasswordEncoder</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BCryptPasswordEncoder</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-在注册接口中加上密码加密"><a href="#3-在注册接口中加上密码加密" class="headerlink" title="3.在注册接口中加上密码加密"></a>3.在注册接口中加上密码加密</h2><p>修改 UserController 中的代码，首先注入加密实例</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Autowired</span><br>BCryptPasswordEncoder bCryptPasswordEncoder;<br></code></pre></td></tr></table></figure><p>然后在注册接口下增加密码进行加密代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">String</span> <span class="hljs-variable">encodePassword</span> <span class="hljs-operator">=</span> bCryptPasswordEncoder.encode(user.getUpassword());<br>user.setUpassword(encodePassword);<br></code></pre></td></tr></table></figure><h2 id="4-在登录时进行密码匹配"><a href="#4-在登录时进行密码匹配" class="headerlink" title="4.在登录时进行密码匹配"></a>4.在登录时进行密码匹配</h2><p>在登录接口下增加匹配代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">User</span> <span class="hljs-variable">userfromJdbc</span> <span class="hljs-operator">=</span> userService.loginService(user.getUname());<br><span class="hljs-comment">//匹配代码</span><br><span class="hljs-keyword">if</span>(!bCryptPasswordEncoder.matches(user.getUpassword(),userfromJdbc.getUpassword()))&#123;<br>    <span class="hljs-keyword">return</span> Result.failure(ResultCodeEnum.UNAUTHORIZED,<span class="hljs-string">&quot;用户名或者密码错误&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span>JWTUtils.getToken(userfromJdbc.getUaccount(),userfromJdbc.getUname());<br>    Map&lt;String,String&gt; userMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    userMap.put(<span class="hljs-string">&quot;userId&quot;</span>,userfromJdbc.getUaccount());<br>    userMap.put(<span class="hljs-string">&quot;userName&quot;</span>,userfromJdbc.getUname());<br>    userMap.put(<span class="hljs-string">&quot;token&quot;</span>,token);<br>    <span class="hljs-keyword">return</span> Result.success(userMap);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>加密</tag>
      
      <tag>Spring Boot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nacos 本地单机版部署(Mac M1)</title>
    <link href="/2023/08/03/Nacos-%E6%9C%AC%E5%9C%B0%E5%8D%95%E6%9C%BA%E7%89%88%E9%83%A8%E7%BD%B2-Mac-M1/"/>
    <url>/2023/08/03/Nacos-%E6%9C%AC%E5%9C%B0%E5%8D%95%E6%9C%BA%E7%89%88%E9%83%A8%E7%BD%B2-Mac-M1/</url>
    
    <content type="html"><![CDATA[<p>一.下载Nacos-server包，最新包2.2.3<br>可以在 github 上 Nacos Release 版本列表中下载最新的稳定版本。地址：<br><a href="https://github.com/alibaba/nacos/releases">https://github.com/alibaba/nacos/releases</a><br>请务必下载最新版，2.1.1以下版本会报错：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">WARN Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#x27;serviceOperatorV2Impl&#x27; defined in URL ...<br></code></pre></td></tr></table></figure><p>2.2.0也会报错，建议m1芯片的mac用2.2.3版本，报错信息如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs test">... Error creating bean with name &#x27;instanceOperatorClientImpl&#x27; defined in URL ...<br></code></pre></td></tr></table></figure><p>二.启动之前配置<br>1.解压nacos-server-2.1.0.zip文件</p><p>2.nacos链接数据库<br>创建数据库：CREATE DATABASE nacos<br>执行nacos中数据库文件：mysql-schema.sql</p><p>3.配置application.properties文件<br>打开这些配置，然后正确配置链接数据库</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs text">#*************** Config Module Related Configurations ***************#<br>### If use MySQL as datasource:<br>### Deprecated configuration property, it is recommended to use `spring.sql.init.platform` replaced.<br>spring.datasource.platform=mysql<br>spring.sql.init.platform=mysql<br><br>### Count of DB:<br>db.num=1<br><br>### Connect URL of DB:<br>db.url.0=jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC<br>db.user.0=nacos<br>db.password.0=nacos<br></code></pre></td></tr></table></figure><p>三.启动nacos服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> nacos/bin<br>sh startup.sh -m standalone <span class="hljs-comment">#standalone 代表着单机模式运行，非集群模式</span><br></code></pre></td></tr></table></figure><p>那如何看 Nacos 日志，从上面可见日志输出在 nacos&#x2F;logs 目录，查看 start.out 日志文件</p><p>访问：<a href="http://localhost:8848/nacos/index.html">http://localhost:8848/nacos/index.html</a>…<br>用户名：nacos<br>密码：nacos</p><p>关闭命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sh shutdown.sh<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
      <tag>Java</tag>
      
      <tag>Nacos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mac OS M1 环境 项目因netty.dns启动失败</title>
    <link href="/2023/08/01/Mac-OS-M1-%E7%8E%AF%E5%A2%83-%E9%A1%B9%E7%9B%AE%E5%9B%A0netty-dns%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5/"/>
    <url>/2023/08/01/Mac-OS-M1-%E7%8E%AF%E5%A2%83-%E9%A1%B9%E7%9B%AE%E5%9B%A0netty-dns%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5/</url>
    
    <content type="html"><![CDATA[<p>Mac OS M1 环境 项目因netty.dns启动失败</p><pre><code class="hljs">    ERROR 2312 --- [ctor-http-nio-2] i.n.r.d.DnsServerAddressStreamProviders  : Unable to load io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS.</code></pre><p>解决方案为<br>引入依赖</p><pre><code class="hljs">    &lt;dependency&gt;            &lt;groupId&gt;io.netty&lt;/groupId&gt;            &lt;artifactId&gt;netty-resolver-dns-native-macos&lt;/artifactId&gt;            &lt;version&gt;XXX&lt;/version&gt;            &lt;classifier&gt;osx-x86_64&lt;/classifier&gt;    &lt;/dependency&gt;</code></pre>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lombok Builder 注解</title>
    <link href="/2023/07/22/Lombok-Builder-%E6%B3%A8%E8%A7%A3/"/>
    <url>/2023/07/22/Lombok-Builder-%E6%B3%A8%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<p>以前使用 new 对象后，再逐行执行 set 方法的方式来给对象赋值的。<br>还有另外一种可能更方便的方式 builder。<br>1）实体类加上 @Builder 等注解：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Builder</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExecuteCodeRequest</span> &#123;<br>    <span class="hljs-keyword">private</span> String code;<br>    <span class="hljs-keyword">private</span> String language;<br></code></pre></td></tr></table></figure><p>2）可以使用链式的方式更方便地给对象赋值：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">ExecuteCodeRequest</span> <span class="hljs-variable">executeCodeRequest</span> <span class="hljs-operator">=</span> ExecuteCodeRequest.builder()<br>    .code(code)<br>    .language(language)<br>    .inputList(inputList)<br>    .build();<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Idea 插件推荐 Generate All Getter And Setter</title>
    <link href="/2023/07/21/idea%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90Generate-All-Getter-And-Setter/"/>
    <url>/2023/07/21/idea%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90Generate-All-Getter-And-Setter/</url>
    
    <content type="html"><![CDATA[<p>使用类似 .var 的后缀模板生成 POJO 的所有 getter 和 setter 方法。<br><a href="https://plugins.jetbrains.com/plugin/18969-generate-all-getter-and-setter">https://plugins.jetbrains.com/plugin/18969-generate-all-getter-and-setter</a></p><ul><li><p>Usage<br>使用 .allget 生成所有 getter 方法。</p></li><li><p>allget<br>使用 .allset 生成所有不带默认值的 setter 方法。</p></li><li><p>allset<br>使用 .allsetv 生成所有带默认值的 setter 方法。</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Idea</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>(转载)使用Gson进行json数据转换list to json 和json to list</title>
    <link href="/2023/07/11/%E4%BD%BF%E7%94%A8Gson%E8%BF%9B%E8%A1%8Cjson%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2list-to-json-%E5%92%8Cjson-to-list/"/>
    <url>/2023/07/11/%E4%BD%BF%E7%94%A8Gson%E8%BF%9B%E8%A1%8Cjson%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2list-to-json-%E5%92%8Cjson-to-list/</url>
    
    <content type="html"><![CDATA[<p>经过比较，gson和其他现有java json类库最大的不同时gson需要序列化得实体类不需要使用annotation来标识需要序列化得字段，<br>同时gson又可以通过使用annotation来灵活配置需要序列化的字段。<br>下面是一个简单的例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;  <br>  <br>    <span class="hljs-keyword">private</span> String name;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;  <br>  <br>    <span class="hljs-comment">/** </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> the name </span><br><span class="hljs-comment">     */</span>  <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> name;  <br>    &#125;  <br>  <br>    <span class="hljs-comment">/** </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> name the name to set </span><br><span class="hljs-comment">     */</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.name = name;  <br>    &#125;  <br>  <br>    <span class="hljs-comment">/** </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> the age </span><br><span class="hljs-comment">     */</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> age;  <br>    &#125;  <br>  <br>    <span class="hljs-comment">/** </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> age the age to set </span><br><span class="hljs-comment">     */</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.age = age;  <br>    &#125;  <br>      <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span>  <br>    &#123;  <br>        <span class="hljs-keyword">return</span> name + <span class="hljs-string">&quot;:&quot;</span> +age;  <br>    &#125;  <br>&#125;  <br></code></pre></td></tr></table></figure><p>实体很简单，两个字段，当然实体中的字段也可以是List或者Set类型的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">Gson</span> <span class="hljs-variable">gson</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Gson</span>();  <br>List&lt;Person&gt; persons = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Person&gt;();  <br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;  <br>     <span class="hljs-type">Person</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();  <br>     p.setName(<span class="hljs-string">&quot;name&quot;</span> + i);  <br>     p.setAge(i * <span class="hljs-number">5</span>);  <br>     persons.add(p);  <br>&#125;  <br><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> gson.toJson(persons);  <br></code></pre></td></tr></table></figure><p>上面的代码重点是Gson对象，它提供了toJason()方法将对象转换成Json字符串，上面代码的str对象值为：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Json"><span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name0&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name1&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name2&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name3&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name4&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name5&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name6&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name7&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">35</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name8&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">40</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;name9&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">45</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span> <br></code></pre></td></tr></table></figure><p>很标准的json数据，很简单吧，呵呵。<br>下面来看看gson的反序列化，Gson提供了fromJson()方法来实现从Json相关对象到java实体的方法。<br>在日常应用中，我们一般都会碰到两种情况，转成单一实体对象和转换成对象列表或者其他结构。<br>先来看第一种：<br>比如json字符串为：[{“name”:”name0”,”age”:0}]<br>代码:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> gson.fromJson(str, Person.class);  <br></code></pre></td></tr></table></figure><p>提供两个参数，分别是json字符串以及需要转换对象的类型。<br>第二种，转换成列表类型：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Java">List&lt;Person&gt; ps = gson.fromJson(str, <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeToken</span>&lt;List&lt;Person&gt;&gt;()&#123;&#125;.getType());  <br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; ps.size() ; i++)  <br>&#123;  <br>     <span class="hljs-type">Person</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> ps.get(i);  <br>     System.out.println(p.toString());  <br>&#125;  <br></code></pre></td></tr></table></figure><p>原文链接：<a href="https://blog.csdn.net/god2030/article/details/51140450">https://blog.csdn.net/god2030/article/details/51140450</a></p>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>为什么需要序列化（Serializable）</title>
    <link href="/2023/07/10/%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%88Serializable%EF%BC%89/"/>
    <url>/2023/07/10/%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%88Serializable%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>最近在学习springmvc+mybatis项目时，发现老师在实体类中引用了serializable这个接口</p><h4 id="百度上是这么讲的"><a href="#百度上是这么讲的" class="headerlink" title="百度上是这么讲的"></a>百度上是这么讲的</h4><p>Serializable接口是启用其序列化功能的接口。实现java.io.Serializable 接口的类是可序列化的。没有实现此接口的类将不能使它们的任意状态被序列化或逆序列化。</p><p>这个介绍非常的不接地气，于是我又去看了几篇博客，有一个小姐姐的博客引起了我的注意，她是这样理解的：<br>序列化的过程，就是一个“freeze”的过程，它将一个对象freeze（冷冻）住，然后进行存储，等到再次需要的时候，再将这个对象de-freeze就可以立即使用。<br>我们以为的没有进行序列化，其实是在声明的各个不同变量的时候，由具体的数据类型帮助我们实现了序列化操作。<br>如果有人打开过Serializable接口的源码，就会发现，这个接口其实是个空接口，那么这个序列化操作，到底是由谁去实现了呢？其实，看一下接口的注释说明就知道，当我们让实体类实现Serializable接口时，其实是在告诉JVM此类可被序列化，可被默认的序列化机制序列化。</p><h2 id="为什么需要序列化"><a href="#为什么需要序列化" class="headerlink" title="为什么需要序列化"></a>为什么需要序列化</h2><ul><li>1，存储对象在存储介质中，以便在下次使用的时候，可以很快捷的重建一个副本。也就是When the resulting series of bits is reread according to the serialization format, it can be used to create a semantically identical clone of the original object.<br>问题：我没有实现序列化的时候，我一样可以存入到我的sqlserver或者MySQL、Oracle数据库中啊，为什么一定要序列化才能存储呢？？？？</li><li>2，便于数据传输，尤其是在远程调用的时候！<br>其实说了这么多，想表达的意思就是：Serializable接口是一个里面什么都没有的接口<br>它的源代码是public interface Serializable{}，即什么都没有。</li></ul><p>如果一个接口里面什么内容都没有，那么这个接口是一个标识接口，比如，一个学生遇到一个问题，排错排了几天也没解决，此时，她举手了（示意我去帮他解决），然后我过去，帮他解决了，那么这个举手其实就是一个标识，自己不能解决的问题标示我去帮他解决，在Java中的这个Serializable接口是给JVM看的，告诉JVM，我不做这个类的序列化了，你(JVM)给我序列化，序列化就是变成二进制流，比如云计算、Hadoop，特别是Hadoop完全就是分布式环境，那么就要涉及到对象要在网络中传输，里面的全是二进制流，当然你来做这个序列化操作也可以，但是这个类里面可能还有一个类，如果你把外面的类对象Person变成二进制，那么里面也要序列化（这要用到深度遍历，很麻烦），干脆告诉JVM，让他来帮你做。<br>serializable接口就是Java提供用来进行高效率的异地共享实例对象的机制，实现这个接口即可。</p><p>转载<a href="https://www.cnblogs.com/wangenxian/p/11003221.html">https://www.cnblogs.com/wangenxian/p/11003221.html</a></p>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mac OS M1 JDK8环境下启动慢</title>
    <link href="/2023/06/28/Mac-OS-M1-JDK8%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%90%AF%E5%8A%A8%E6%85%A2/"/>
    <url>/2023/06/28/Mac-OS-M1-JDK8%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%90%AF%E5%8A%A8%E6%85%A2/</url>
    
    <content type="html"><![CDATA[<p>同样的网络环境，同一个SpringBoot项目<br>在win10下启动，需要10秒左右<br>在macOS下启动，竟然需要23多秒<br>换成JDK17后也快了不少，JDK8也是下载ARM版本的</p><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><ul><li>修改&#x2F;etc&#x2F;hosts文件</li></ul><p>打开终端输入hostname，查看你的mac的主机名称（xxxMacBook.local）<br>没修改前应该是这个样子</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs text">##<br># Host Database<br>#<br># localhost is used to configure the loopback interface<br># when the system is booting.  Do not change this entry.<br>##<br>127.0.0.1localhost<br>255.255.255.255broadcasthost<br>::1localhost<br></code></pre></td></tr></table></figure><p>把它改成这个样子</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs text">##<br># Host Database<br>#<br># localhost is used to configure the loopback interface<br># when the system is booting.  Do not change this entry.<br>##<br>127.0.0.1localhost xxxMacBook.local<br>255.255.255.255broadcasthost<br>::1localhost xxxMacBook.local <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>后端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mac</tag>
      
      <tag>Java</tag>
      
      <tag>Spring Boot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vscode开发vue+ts项目 报错：找不到模块或其相应的类型声明</title>
    <link href="/2023/06/25/Vscode%E5%BC%80%E5%8F%91ts%E9%A1%B9%E7%9B%AE-%E6%8A%A5%E9%94%99%EF%BC%9A%E6%89%BE%E4%B8%8D%E5%88%B0%E6%A8%A1%E5%9D%97%E6%88%96%E5%85%B6%E7%9B%B8%E5%BA%94%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E/"/>
    <url>/2023/06/25/Vscode%E5%BC%80%E5%8F%91ts%E9%A1%B9%E7%9B%AE-%E6%8A%A5%E9%94%99%EF%BC%9A%E6%89%BE%E4%B8%8D%E5%88%B0%E6%A8%A1%E5%9D%97%E6%88%96%E5%85%B6%E7%9B%B8%E5%BA%94%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E/</url>
    
    <content type="html"><![CDATA[<p>报错：找不到模块或其相应的类型声明。（Vue 3 can not find module）</p><p>报错原因：typescript 只能理解 .ts 文件，无法理解 .vue文件</p><p>解决方法：在项目根目录下创建一个后缀为 vue.d.ts 的文件，并写入以下内容：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs text">// 以下两种方案二选一<br>// 方案一 <br>declare module &quot;*.vue&quot; &#123; import Vue from &quot;vue&quot;; export default Vue; &#125; <br>// 方案二 <br>declare module &#x27;*.vue&#x27; &#123; import &#123; defineComponent &#125; from &#x27;vue&#x27;; const Component: ReturnType&lt;typeof defineComponent&gt;; export default Component &#125;<br></code></pre></td></tr></table></figure><p>然后在tsconfig.json中写入一下内容：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">&quot;include&quot;: [&quot;src/**/*.ts&quot;, &quot;src/**/*.d.ts&quot;, &quot;src/**/*.tsx&quot;, &quot;src/**/*.vue&quot;, &quot;vue.d.ts&quot;],<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>前端</category>
      
    </categories>
    
    
    <tags>
      
      <tag>typescript</tag>
      
      <tag>vue</tag>
      
      <tag>vscode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用Dockerfile构建Python、Java开发环境</title>
    <link href="/2023/01/21/%E4%BD%BF%E7%94%A8Dockerfile%E6%9E%84%E5%BB%BAPython%E3%80%81Java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    <url>/2023/01/21/%E4%BD%BF%E7%94%A8Dockerfile%E6%9E%84%E5%BB%BAPython%E3%80%81Java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<p>平时构建项目镜像用的是 openjdk:8-jdk-alpine，因为构建方便且用到 Java 环境。</p><p>现在的代码沙箱需要用到 <a href="https://github.com/dojiong/Lo-runner">Lo-runner</a> ，需要 Java + python 环境。</p><p>因此用 ubuntu 作为基础镜像，安装 openjdk-8-jdk 和 python3 ，下面是Dockerfile文件内容：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># 使用 Ubuntu 18.04 作为基础镜像</span><br><span class="hljs-keyword">FROM</span> ubuntu:<span class="hljs-number">18.04</span><br><br><span class="hljs-comment"># 设置为中国国内源</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> sed -i <span class="hljs-string">&#x27;s/archive.ubuntu.com/mirrors.aliyun.com/g&#x27;</span> /etc/apt/sources.list</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> sed -i <span class="hljs-string">&#x27;s/security.ubuntu.com/mirrors.aliyun.com/g&#x27;</span> /etc/apt/sources.list</span><br><br><span class="hljs-comment"># 更新包列表并安装基本软件包</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; \</span><br><span class="language-bash">    apt-get install -y \</span><br><span class="language-bash">    <span class="hljs-comment"># 在这里添加你需要的软件包，以空格分隔 \</span></span><br><span class="language-bash">    openjdk-8-jdk \</span><br><span class="language-bash">    python3 \</span><br><span class="language-bash">    python3-pip \</span><br><span class="language-bash">    &amp;&amp; apt-get update --fix-missing \</span><br><span class="language-bash">    &amp;&amp; apt-get clean \</span><br><span class="language-bash">    &amp;&amp; <span class="hljs-built_in">rm</span> -rf /var/lib/apt/lists/*</span><br><br><span class="hljs-comment"># 设置环境变量，指定 Java 默认版本</span><br><span class="hljs-keyword">ENV</span> JAVA_HOME /usr/lib/jvm/java-<span class="hljs-number">8</span>-openjdk-amd64<br><span class="hljs-keyword">ENV</span> PATH $PATH:$JAVA_HOME/bin<br><br><span class="hljs-comment"># 将脚本添加到工作目录</span><br><span class="hljs-keyword">ADD</span><span class="language-bash"> acm-judge-module/ /app/acm-judge-module/</span><br><br><span class="hljs-comment"># 指定工作目录</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app/acm-judge-module/judge/</span><br><br><span class="hljs-comment"># 将 jar 包添加到工作目录</span><br><span class="hljs-keyword">ADD</span><span class="language-bash"> target/nutoj-code-sandbox-0.0.1-SNAPSHOT.jar /app/acm-judge-module/judge/</span><br><br><span class="hljs-comment"># 运行 python3 setup.py install</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">cd</span> /app/acm-judge-module/ &amp;&amp; \</span><br><span class="language-bash">    python3 setup.py install &amp;&amp; \</span><br><span class="language-bash">    <span class="hljs-built_in">cd</span> judge/</span><br><br><span class="hljs-comment"># 暴露端口</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8090</span><br><br><span class="hljs-comment"># 启动命令</span><br><span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="hljs-string">&quot;java&quot;</span>,<span class="hljs-string">&quot;-jar&quot;</span>,<span class="hljs-string">&quot;/app/acm-judge-module/judge/nutoj-code-sandbox-0.0.1-SNAPSHOT.jar&quot;</span>]</span><br></code></pre></td></tr></table></figure><h2 id="下面是python环境偶尔会出先的问题"><a href="#下面是python环境偶尔会出先的问题" class="headerlink" title="下面是python环境偶尔会出先的问题"></a>下面是python环境偶尔会出先的问题</h2><p>首先要升级一下yum和部分依赖包避免安装时出现莫名其妙的错误：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum update -y<br> <br>yum -y groupinstall &quot;Development tools&quot;<br> <br>yum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel psmisc libffi-devel <br></code></pre></td></tr></table></figure><p>安装python包的时候或许会出现一下错误：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">致命错误：Python.h：没有那个文件或目录<br>      | #include &lt;Python.h&gt;<br>      |          ^~~~~~~~~~<br>编译中断。<br>error: command &#x27;/usr/bin/gcc&#x27; failed with exit code 1<br></code></pre></td></tr></table></figure><p>解决方案：<br>安装python开发包</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@username ~]# yum install python3-devel<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>部署</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
